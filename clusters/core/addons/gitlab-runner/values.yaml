gitlab-runner:
  gitlabUrl: https://git.example.com

  runners:
    ## The name of the secret containing runner-token and runner-registration-token
    secret: gitlab-runner-token

  rbac:
    ## Specifies whether a Role and RoleBinding should be created
    ## If this value is set to `true`, `serviceAccount.create` should also be set to either `true` or `false`
    ##
    create: true

  metrics:
    enabled: false

    ## Define a name for the metrics port
    ##
    portName: metrics

    ## Provide a port number for the integrated Prometheus metrics exporter
    ##
    port: 9252

    ## Configure a prometheus-operator serviceMonitor to allow autodetection of
    ## the scraping target. Requires enabling the service resource below.
    ##
    ## DEPRECATED: Use podMonitor instead. ServiceMonitor requires a Service and
    ## cannot collect metrics during graceful shutdown when pods are marked NotReady.
    ##
    serviceMonitor:
      enabled: true

  service:
    enabled: true

  resources: {}
    # limits:
    #   memory: 256Mi
    #   cpu: 200m
    #   ephemeral-storage: 512Mi
    # requests:
    #   memory: 128Mi
    #   cpu: 100m
    #   ephemeral-storage: 256Mi

  nodeSelector: {}
    # Example: The gitlab runner manager should not run on spot instances so you can assign
    # them to the regular worker nodes only.
    # node-role.kubernetes.io/worker: "true"

  ## List of node taints to tolerate (requires Kubernetes >= 1.6)
  ## ref: https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/
  ##
  tolerations: []
    # Example: Regular worker nodes may have a taint, thus you need to tolerate the taint
    # when you assign the gitlab runner manager with nodeSelector or affinity to the nodes.
    # - key: "node-role.kubernetes.io/worker"
    #   operator: "Exists"

# This section enables configuration for using External Secrets Operator (ESO) as the secret manager.
# Prerequisite: Ensure that ESO is installed in the cluster.
# Refer to the EDP cluster add-on for ESO installation and setup:
# https://github.com/epam/edp-cluster-add-ons/tree/main/clusters/core/addons/external-secrets
#
# Ensure that you have created the necessary roles for ESO integration.
# Follow the detailed instructions here:
# https://docs.kuberocketci.io/docs/operator-guide/secrets-management/external-secrets-operator-integration#aws-parameter-store-scenario-in-kuberocketci
eso:
  # -- Install components of the ESO.
  enabled: true
  # -- Defines provider type. One of `aws`, `generic`, or `vault`.
  provider: "aws"
  # -- Value name in AWS ParameterStore, AWS SecretsManager or other Secret Store.
  secretPath: "/infra/core/addons/gitlab-runner"
  # -- Vault configuration (if provider is `vault`).
  vault:
    # -- Vault server URL.
    server: "http://vault.vault:8200"
    # -- Mount path for the Kubernetes authentication method.
    mountPath: "core"
    # -- Vault role for the Kubernetes authentication method.
    role: gitlab
  # -- AWS configuration (if provider is `aws`).
  aws:
    # -- AWS region.
    region: "eu-central-1"
    # -- AWS role ARN for the ExternalSecretOperator to assume.
    roleArn: "arn:aws:iam::012345678910:role/AWSIRSA_Shared_ExternalSecretOperatorAccess"
  generic:
    secretStore:
      # -- Defines SecretStore provider configuration.
      providerConfig: {}
      #  gcpsm:
      #    projectID: "alphabet-123"
